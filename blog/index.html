
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>刘毅同学</title>
  <meta name="author" content="liuyix">

  
  <meta name="description" content="Python并发编程常用的就是2个模块：threading和multiprocessing。其中threading因为著名的GIL，实际是伪多线程，每个thread并没有对应一个pthread；multiprocessing则是利用多进程的手段来绕过GIL达到并发的效果。 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://liuyix.org/blog">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="刘毅同学" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.useso.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.useso.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.useso.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<!--<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/footnote.js" type="text/javascript"></script>-->

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-39126484-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">刘毅同学</a></h1>
  
    <h2>About Python, MySQL & Life</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:liuyix.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog">Blogs</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/splash2-benchmark">SPLASH-2 Benchmark</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/python-concurrent-programming/">Python并发实用编程手册</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-12-17T07:08:00+08:00" pubdate data-updated="true">Dec 17<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Python并发编程常用的就是2个模块：<code>threading</code>和<code>multiprocessing</code>。其中<code>threading</code>因为著名的GIL，实际是<em>伪多线程</em>，每个thread并没有对应一个pthread；<code>multiprocessing</code>则是利用多进程的手段来绕过GIL达到并发的效果。</p>

<p>如果你的任务并非是CPU密集型，而是IO密集型或者网络应用的话——单线程时CPU总是处于等待的状态时，用threading其实影响不大。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/how-to-be-a-morning-man/">成为早起者的几个步骤[Quora]</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-12-17T06:46:00+08:00" pubdate data-updated="true">Dec 17<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>原文链接：<a href="https://www.quora.com/How-do-I-become-a-morning-person-1">How do I become a morning person?</a></p>

<p>如何成为一个牛逼的Morning Person,也困扰了我很久。虽然现在依旧没有成功（捂脸）。成为Moring Person后就可以每天早上5点起来在无人打扰的环境里做自己喜欢的或者和梦想有关的事情，当然也可以给自己做一份丰盛的早餐，或者起来加班&hellip;.</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/how-to-be-a-morning-man/">继续阅读 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/my-quora-digest-issue-1/">Quora每周摘选(第1期)</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-12-15T23:13:00+08:00" pubdate data-updated="true">Dec 15<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>因为订阅了Quora Digest，发现推送的邮件里面好多不错的文章。这里每周会从我读到的Quora里面翻译部分精选。</p></blockquote>

<ul>
<li><a href="https://www.quora.com/How-do-I-become-a-morning-person-1">How do I become a morning person?</a> ==> <a href="http://liuyix.org/blog/2015/how-to-be-a-morning-man/">成为早起者的几个步骤</a>

<ul>
<li>这篇Post提供了几个比较有效的早起的技巧，最打动我的就是早起你要有一个让自己兴奋到必须要早起的理由。</li>
</ul>
</li>
<li><a href="https://www.quora.com/Is-staying-a-software-engineer-your-whole-life-a-good-career-choice">Is staying a software engineer your whole life a good career choice?</a> ==> 选择做一辈子软件开发是否明智？

<ul>
<li>其实无论在国内还是国外，程序员的职业发展都差不多，要么转管理要么继续Coding</li>
</ul>
</li>
<li><a href="http://qr.ae/RbVArL">What are some of the most important things that we should be informed about in life?</a> ==> 有哪些生活中我们应该知道的重要的事？

<ul>
<li>还是一篇在<em>Life Lessons</em>版过万的upvote的帖子，这周有时间翻译下。</li>
</ul>
</li>
<li>(What are some &lsquo;unofficial mottos&rsquo; of programming languages?)[<a href="https://www.quora.com/What-are-some-unofficial-mottos-of-programming-languages">https://www.quora.com/What-are-some-unofficial-mottos-of-programming-languages</a>]

<ul>
<li>笑点低的我看到强力吐槽能量的帖子，笑个不停</li>
</ul>
</li>
</ul>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/my-quora-digest-issue-1/">继续阅读 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/python-data-model/">Python Data Model</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-10-22T08:41:00+08:00" pubdate data-updated="true">Oct 22<span>nd</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><blockquote><p>本文介绍了『Python Data Model』官方的总结笔记，主要内容是Python对象的详细介绍</p></blockquote>

<p>Original: <a href="https://docs.python.org/2/reference/datamodel.html#data-model">https://docs.python.org/2/reference/datamodel.html#data-model</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/python-docopt/">Docopt &#8211; Python必备的命令行接口模块</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-10-21T00:02:00+08:00" pubdate data-updated="true">Oct 21<span>st</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>docopt很适合经常需要用python写命令行工具的同学使用。</p>

<h2>docopt之前</h2>

<p>工作需要，经常会用大块的代码来定(ren)义(rou)命令行界面的工具。代码经常是如下的样子：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="kn">import</span> <span class="nn">optparse</span>
</span><span class='line'>
</span><span class='line'><span class="n">parser</span> <span class="o">=</span> <span class="n">optparse</span><span class="o">.</span><span class="n">OptionParser</span><span class="p">()</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&#39;--foo&#39;</span><span class="p">,</span> <span class="s">&#39;-f&#39;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">&#39;1&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s">&#39;int&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">parser</span><span class="o">.</span><span class="n">add_option</span><span class="p">(</span><span class="s">&#39;--bar&#39;</span><span class="p">,</span> <span class="s">&#39;-b&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s">&#39;store_true&#39;</span><span class="p">)</span>
</span><span class='line'><span class="c"># 类似以上的代码大概几十行</span>
</span><span class='line'>
</span><span class='line'><span class="n">opts</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure>


<p>每一个python脚本都需要提供类似的接口。因此每一次都需要写类似的代码。在写过几次后为了保持DRY原则，我将初始化parser封装为一个method放在util部分。可是依旧是逃不过重复的写<code>parser.add_option</code>。不止一次地我考虑干脆自己写个模板类，以后命令行的定义直接以配置文件的形式写出来，然后每次都通过读取这个配置文件自动化的去生成parser。我相信这个问题我一定不是第一个遇到，应该会有已知的模块解决这个laber intensive的工作。</p>

<p>正在这个时候，偶然看到Python weekly发现了docopt</p>

<h2>docopt</h2>

<p>docopt官网地址：<a href="http://docopt.org/">http://docopt.org/</a></p>

<p>docopt的作者有一个30分钟的视频很好的介绍了docopt这个moudule。推荐大家看一下，自备梯子~ <a href="https://youtu.be/pXhcPJK5cMc">https://youtu.be/pXhcPJK5cMc</a></p>

<p>更令懒人们惊喜的是作者还制作了一个js版本的docopt，可以让你在浏览器中把玩docopt： <a href="http://try.docopt.org/">http://try.docopt.org/</a></p>

<p>使用docopt后，代码上会更加Pythonic，具有很高的可读性，命令行接口的定义所见即所得的样式：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#docopt example</span>
</span><span class='line'>
</span><span class='line'><span class="n">mydoc</span> <span class="o">=</span> <span class="s">&quot;&quot;&quot;Naval Fate.</span>
</span><span class='line'>
</span><span class='line'><span class="s">Usage:</span>
</span><span class='line'><span class="s">  naval_fate.py ship new &lt;name&gt;...</span>
</span><span class='line'><span class="s">  naval_fate.py ship &lt;name&gt; move &lt;x&gt; &lt;y&gt; [--speed=&lt;kn&gt;]</span>
</span><span class='line'><span class="s">  naval_fate.py ship shoot &lt;x&gt; &lt;y&gt;</span>
</span><span class='line'><span class="s">  naval_fate.py mine (set|remove) &lt;x&gt; &lt;y&gt; [--moored|--drifting]</span>
</span><span class='line'><span class="s">  naval_fate.py -h | --help</span>
</span><span class='line'><span class="s">  naval_fate.py --version</span>
</span><span class='line'>
</span><span class='line'><span class="s">Options:</span>
</span><span class='line'><span class="s">  -h --help     Show this screen.</span>
</span><span class='line'><span class="s">  --version     Show version.</span>
</span><span class='line'><span class="s">  --speed=&lt;kn&gt;  Speed in knots [default: 10].</span>
</span><span class='line'><span class="s">  --moored      Moored (anchored) mine.</span>
</span><span class='line'><span class="s">  --drifting    Drifting mine.</span>
</span><span class='line'><span class="s">&quot;&quot;&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="kn">from</span> <span class="nn">docopt</span> <span class="kn">import</span> <span class="n">docopt</span>
</span><span class='line'>
</span><span class='line'><span class="n">arguments</span> <span class="o">=</span> <span class="n">docopt</span><span class="p">(</span><span class="n">mydoc</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s">&#39;0.1&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="n">arguments</span>
</span></code></pre></td></tr></table></div></figure>


<p>这样就定义了一个丰富的命令行接口。命令行接口提供了<code>--help</code>和<code>--version</code>两个基础功能。其中<code>--help</code>输出<code>mydoc</code>，<code>--version</code>输出指定的<code>version</code>信息。</p>

<p>接口还提供了2个参数（ship, mine），每种参数还提供了不同的几种参数的组合。其中<code>[...]</code>内是可选参数，<code>(...|...)</code>是互斥参数。</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/new-mac-test/">Octopress迁移到新主机</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-08-24T00:04:00+08:00" pubdate data-updated="true">Aug 24<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>新机器上首先是把ssh key加入到github的setting，然后配置好基本的git信息（email, name），此处步骤略过。可以参考：<a href="https://help.github.com/articles/set-up-git/">https://help.github.com/articles/set-up-git/</a></li>
<li><code>git clone -b source git@github.com:username/username.github.com.git octopress</code>

<ul>
<li>操作完这一步后就相当于把当前octopress的source文档拉到了本地了。</li>
<li><strong>这一步操作前一定要确保在其他机器上的markdown文件以及其他配置文件的修改都已经push到source分支了，否则这一步会导致博客文章丢失！！！</strong></li>
</ul>
</li>
<li>进入到octopress, 然后<code>git clone git@github.com:username/username.github.com.git _deploy</code>

<ul>
<li>这一步是在<code>_deploy</code>建立好指向master分支的git仓库，方便之后发布文章时使用</li>
</ul>
</li>
<li>安装octopress相关的ruby依赖等

<ul>
<li>建议修改rubygems的安装源到国内的taobao源，详细操作步骤：<a href="http://ruby.taobao.org/">http://ruby.taobao.org/</a>，默认的rubygems.org源已经被墙，速度很慢。</li>
</ul>
</li>
</ul>


<p>完成上面几步后，就可以尝试调用<code>rake generate</code>生成一次网站，然后<code>rake deploy</code>看下是否成功~</p>

<h3>在不同主机上使用Octopress上发布文章</h3>

<p>每次发布新的文章或者修改现有文章时，需要把<code>source</code>分支的修改（即octopress目录所指向的git仓库分支）commit并且push到github上，之后在另外的主机上首先进入到octopress目录，在编辑文章前首先<code>git pull</code>下拉取修改。这样的编辑才能连贯，不然会发生文章丢失的情况。</p>

<p>Reference:</p>

<ul>
<li><a href="http://blog.zerosharp.com/clone-your-octopress-to-blog-from-two-places/">Clone Your Octopress to Blog From Two Places</a></li>
</ul>


<p>-EOF-</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/python-in-industry/">由互联网中的Python应用想到的网站架构的优化</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-08T22:56:00+08:00" pubdate data-updated="true">Apr 8<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><ul>
<li>国内<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>

<ul>
<li>知乎</li>
<li>豆瓣</li>
<li>果壳网</li>
</ul>
</li>
<li>国外，只列出我认识的比较出名的，还有好多<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>=。=

<ul>
<li>Quora 国外的知乎？</li>
<li>Dropbox 国外的金山快盘？</li>
<li>Disqus 国外的多说？</li>
<li>Pinterest 国外的花瓣？</li>
<li>Youtube 国外的优酷？</li>
<li>Slideshare 国外的百度文库？</li>
<li>reddit 国外的猫扑？</li>
<li>Yelp 国外的大众点评</li>
<li>&hellip;</li>
</ul>
</li>
</ul>


<p>更多的信息可以参考Python官网的<a href="https://www.python.org/about/success/">Python Success Stories</a>。</p>

<h3>Quora</h3>

<p>下面是QuorWhy did Quora choose Python for its development?a创始人在Quora上对<em>Why did Quora choose Python for its development?</em>的回答<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup></p>

<blockquote><p>We decided that Python was fast enough for most of what we need to do (since we push our performance-critical code to backend servers written in C++ whenever possible). As far as typechecking, we ended up writing very thorough unit tests which are worth writing anyway, and achieve most of the same goals.</p></blockquote>

<p>可以看到对于Python的性能短板，Quora在performance-critical的地方尽可能换用了C++。对于Python没有静态类型，Quora用尽可能的单元测试来确保质量。之所以选择Python其实很大的原因是Founder对Python比较擅长。
进一步google了下，他们的框架用的Pylon。</p>

<h3>知乎的技术架构</h3>

<p>知乎CTO在去年年底有过分享，目前在InfoQ上能找到整理稿。链接：<a href="http://www.infoq.com/cn/news/2014/12/zhihu-architecture-evolution">http://www.infoq.com/cn/news/2014/12/zhihu-architecture-evolution</a></p>

<p>简而言之用的tornado，自己开发了日志系统Kids，消息传递系统Sink，还有页面渲染ZhihuNode。</p>

<h3>网站架构及性能的思考</h3>

<p>本周听了一次FB周海平在阿里内部的一次分享。无论是阿里、Facebook还是豆瓣，我发现了在网站架构上这几家有很多共同点的：</p>

<ul>
<li>MySQL作为存储后端</li>
<li>MySQL上一定有memcache、tair这样的KV系统做缓存</li>
<li>都各自开发了适合自己的消息分发系统，Notify, Thrift, Beanstalkd</li>
<li>后端应该都具有实时日志数据分析： HBase、云梯2、Kids</li>
<li>不同程度上用异步化来提高性能，并会一直以此来作为性能提升的方法。</li>
<li>消息链路上的优化：一个网页的渲染上是树状结构的获取数据，因此可以在通过优化这棵树来达到优化整个过程的目的</li>
</ul>


<h3>其他</h3>

<p>网站选型不单纯是比较语言优劣，还和社区的发展趋势活跃(谁都不想用过一门可能几年就无人问津的语言)、团队内普遍的好恶和掌控能力（C、C++最好，但是大家都不会）、整个行业的形势（团队内都用Lisp，但是招不到人）等等多种因素有关系。
选择哪门语言确实重要，这决定了未来几年或者更远的时间内技术的发展路线，更重要的当规模扩大后需要在性能优化上要付出的代价。（这里面可以拿Facebook优化PHP作为反例，若是当初扎克用的是java或者c++，也许也不会因此如此兴师动众的重写了PHP生态系统里面的大部分东西。）</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p><a href="http://www.zhihu.com/question/19685768">知乎-国内使用 Python 作为主要开发语言的知名网站有哪些</a><a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p><a href="http://www.quora.com/Which-Internet-companies-use-Python">Quora-Which Internet companies use Python?</a><a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p><a href="http://www.quora.com/Why-did-Quora-choose-Python-for-its-development">Quora-Why did Quora choose Python for its development?</a><a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/git-workflow/">Git Workflow</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-05T23:30:00+08:00" pubdate data-updated="true">Apr 5<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Git近几年有逐渐取代svn的趋势，一部分原因是github的风靡，google code也关门大吉，令人唏嘘<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>。很多公司开始逐渐从svn代码仓库迁移到企业私有版的github&mdash;<a href="https://gitlab.com/">gitlab</a>。知道怎么玩git是大势所趋。</p>

<p>Git小白推荐读物：atlassian出版的<a href="https://www.atlassian.com/git/tutorials">Git Tutorials</a>，这家公司拥有mac上最佳git客户端SourceTree以及Bitbucket。</p>

<p>本文是对<a href="https://www.atlassian.com/git/tutorials/comparing-workflows">Comparing Workflows</a>这篇文章和自己的使用心得所做的总结。</p>

<p>以下三种工作流只是典型的代表，不是规范，而是参考，可以结合自己的使用特点灵活选择和修改。</p>

<ul>
<li>Centralized Workflow</li>
<li>Feature Branch Workflow</li>
<li>Gitflow</li>
</ul>


</div>
  
  
    <footer>
      <a rel="full-article" href="/blog/2015/git-workflow/">继续阅读 &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/mysql-gtid-introduction/">MySQL 5.6 GTID 学习笔记</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-20T18:45:00+08:00" pubdate data-updated="true">Sep 20<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Reading List</h3>

<ul>
<li>Facebook部署5.6 GTID的blog: <a href="https://www.facebook.com/notes/mysql-at-facebook/lessons-from-deploying-mysql-gtid-at-scale/10152252699590933">Lessons from Deploying MySQL GTID at Scale</a>(需要翻墙)

<ul>
<li>Facebook@Percona Live 2014 <a href="http://www.percona.com/live/mysql-conference-2014/sessions/global-transaction-id-facebook">GLOBAL TRANSACTION ID AT FACEBOOK</a></li>
<li>MySQL Manual使用时GTID时的限制：<a href="http://dev.mysql.com/doc/refman/5.6/en/replication-gtids-restrictions.html">17.1.3.4 Restrictions on Replication with GTIDs</a></li>
</ul>
</li>
<li></li>
</ul>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2014/bash-tips/">Bash Tips</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2014-09-14T16:59:00+08:00" pubdate data-updated="true">Sep 14<span>th</span>, 2014</time>
        
      </p>
    
  </header>


  <div class="entry-content"><h3>Bash 遇到错误就退出</h3>

<p><a href="http://stackoverflow.com/a/4382179">http://stackoverflow.com/a/4382179</a></p>

<p><code>set -e</code></p>

<blockquote><p>If you put set -e in a script, the script will terminate as soon as any command inside it fails (i.e. as soon as any command returns a nonzero status). This doesn&rsquo;t let you write your own message, but often the failing command&rsquo;s own messages are enough.</p>

<p>The advantage of this approach is that it&rsquo;s automatic: you don&rsquo;t run the risk of forgetting to deal with an error case.</p>

<p>Commands whose status is tested by a conditional (such as if, &amp;&amp; or ||) do not terminate the script (otherwise the conditional would be pointless). An idiom for the occasional command whose failure doesn&rsquo;t matter is command-that-may-fail || true. You can also turn set -e off for a part of the script with set +e.</p></blockquote>

<h2>Bash使用数组</h2>

<h3>快速入门</h3>

<p>(Bash For Loop Array: Iterate Through Array Values)[<a href="http://www.cyberciti.biz/faq/bash-for-loop-array/">http://www.cyberciti.biz/faq/bash-for-loop-array/</a>]</p>

<ul>
<li>用括号指定，空格指定就好</li>
<li>遍历： <code>for i in "${var[@]}"</code></li>
</ul>


<h3>深入</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>#!/bin/bash
</span><span class='line'># array-ops.sh: More fun with arrays.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>array=( zero one two three four five )
</span><span class='line'># Element 0   1   2    3     4    5
</span><span class='line'>
</span><span class='line'>echo ${array[0]}       #  zero
</span><span class='line'>echo ${array:0}        #  zero
</span><span class='line'>                       #  Parameter expansion of first element,
</span><span class='line'>                       #+ starting at position # 0 (1st character).
</span><span class='line'>echo ${array:1}        #  ero
</span><span class='line'>                       #  Parameter expansion of first element,
</span><span class='line'>                       #+ starting at position # 1 (2nd character).
</span><span class='line'>
</span><span class='line'>echo "--------------"
</span><span class='line'>
</span><span class='line'>echo ${#array[0]}      #  4
</span><span class='line'>                       #  Length of first element of array.
</span><span class='line'>echo ${#array}         #  4
</span><span class='line'>                       #  Length of first element of array.
</span><span class='line'>                       #  (Alternate notation)
</span><span class='line'>
</span><span class='line'>echo ${#array[1]}      #  3
</span><span class='line'>                       #  Length of second element of array.
</span><span class='line'>                       #  Arrays in Bash have zero-based indexing.
</span><span class='line'>
</span><span class='line'>echo ${#array[*]}      #  6
</span><span class='line'>                       #  Number of elements in array.
</span><span class='line'>echo ${#array[@]}      #  6
</span><span class='line'>                       #  Number of elements in array.
</span><span class='line'>
</span><span class='line'>echo "--------------"
</span><span class='line'>
</span><span class='line'>array2=( [0]="first element" [1]="second element" [3]="fourth element" )
</span><span class='line'>#            ^     ^       ^     ^      ^       ^     ^      ^       ^
</span><span class='line'># Quoting permits embedding whitespace within individual array elements.
</span><span class='line'>
</span><span class='line'>echo ${array2[0]}      # first element
</span><span class='line'>echo ${array2[1]}      # second element
</span><span class='line'>echo ${array2[2]}      #
</span><span class='line'>                       # Skipped in initialization, and therefore null.
</span><span class='line'>echo ${array2[3]}      # fourth element
</span><span class='line'>echo ${#array2[0]}     # 13    (length of first element)
</span><span class='line'>echo ${#array2[*]}     # 3     (number of elements in array)
</span><span class='line'>
</span><span class='line'>exit</span></code></pre></td></tr></table></div></figure>


<p>(Arrays)[<a href="http://www.tldp.org/LDP/abs/html/arrays.html">http://www.tldp.org/LDP/abs/html/arrays.html</a>]</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>About</h1>
  <p>id: @<a href="http://weibo.com/liuyix" target="_blank">liuyix</a></br>
  <center>
  All articles licensed under
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.zh" target="_blank" title="Licensed under CC BY-SA 3.0"><img src="/images/cc.png"></a>
<center>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/python-concurrent-programming/">Python并发实用编程手册</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/how-to-be-a-morning-man/">成为早起者的几个步骤[Quora]</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/my-quora-digest-issue-1/">Quora每周摘选(第1期)</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/python-data-model/">Python Data Model</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/python-docopt/">Docopt &#8211; Python必备的命令行接口模块</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Categories</h1>
    <ul id="category-list"><li><a href='/blog/categories/android'>android (4)</a></li><li><a href='/blog/categories/general'>General (10)</a></li><li><a href='/blog/categories/life'>Life (9)</a></li><li><a href='/blog/categories/linux'>Linux (12)</a></li><li><a href='/blog/categories/mac'>Mac (1)</a></li><li><a href='/blog/categories/mysql'>MySQL (1)</a></li><li><a href='/blog/categories/octopress'>Octopress (4)</a></li><li><a href='/blog/categories/python'>Python (4)</a></li><li><a href='/blog/categories/quora'>Quora (1)</a></li><li><a href='/blog/categories/wordpress'>Wordpress (1)</a></li></ul>
</section>






  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - liuyix -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  











</body>
</html>
